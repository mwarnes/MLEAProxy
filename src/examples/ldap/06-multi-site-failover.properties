# ================================================================
# LDAP Example 6: Multi-Site Failover
# ================================================================
# Description: Load balance within sites, with failover between sites
# Provides both load distribution and geographic redundancy
#
# Architecture:
#   - Primary Site: server1, server2 (load balanced)
#   - Secondary Site: server3, server4 (load balanced)
#   - Automatic failover if primary site is unavailable
#
# Usage:
#   1. Update server hosts and ports for both sites
#   2. Configure server sets (set1 = primary, set2 = secondary)
#   3. Copy this file to the root directory as mleaproxy.properties
#   4. Run: java -jar mleaproxy.jar
#   5. Test: ldapsearch -H ldap://localhost:30389 \
#            -D "cn=admin,dc=example,dc=com" \
#            -w password -b "dc=example,dc=com" \
#            "(uid=user1)"
# ================================================================

# Enable LDAP debug logging
ldap.debug=true

# ================================================================
# LDAP Listeners
# ================================================================
listeners=proxy

# ----------------------------------------------------------------
# LDAP Listener: proxy
# ----------------------------------------------------------------
listener.proxy.ipaddress=0.0.0.0
listener.proxy.port=30389
listener.proxy.debuglevel=DEBUG
listener.proxy.ldapset=set1,set2
listener.proxy.ldapmode=roundrobin
listener.proxy.requestProcessor=ldapproxy
listener.proxy.description=Multi-site load balancing with failover

# ================================================================
# Request Processors
# ================================================================
requestProcessor.ldapproxy.authclass=com.marklogic.processors.ProxyRequestProcessor
requestProcessor.ldapproxy.debuglevel=DEBUG

# ================================================================
# LDAP Server Sets
# ================================================================
# Primary Site - Server Set 1
ldapset.set1.servers=server1,server2

# Secondary Site - Server Set 2
ldapset.set2.servers=server3,server4

# ================================================================
# LDAP Servers - Primary Site
# ================================================================
# Primary Site - LDAP server 1
ldapserver.server1.host=192.168.0.50
ldapserver.server1.port=10389

# Primary Site - LDAP server 2
ldapserver.server2.host=192.168.0.51
ldapserver.server2.port=10389

# ================================================================
# LDAP Servers - Secondary Site
# ================================================================
# Secondary Site - LDAP server 3
ldapserver.server3.host=192.168.0.52
ldapserver.server3.port=10389

# Secondary Site - LDAP server 4
ldapserver.server4.host=192.168.0.53
ldapserver.server4.port=10389
